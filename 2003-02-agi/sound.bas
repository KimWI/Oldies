10 MAXFILES=2:OPEN"sndDIR"AS1LEN=1:FIELD1,1ASN$:PRINT"Figura (0-";(LOF(1)/3)-1;")";:INPUTN:FORI=0TO2:GET1,N*3+I+1:A(I)=ASC(N$):NEXT:V=A(0)\16:P=((A(0)AND15)*256+A(1))*256+A(2):IFV>2THENPRINT"Nao existe. Tente outra.":ENDELSECLOSE
20 P=P+1:OPEN"VOL."+RIGHT$(STR$(V),1)AS1LEN=1:FIELD1,1ASN$:GET1,P:A=ASC(N$):GET1,P+1:B=ASC(N$):GET1,P+2:C=ASC(N$):IFNOT(&H12=AAND&H34=BANDC=V)THENPRINT"Invalido.":ENDELSEGET1,P+3:L=ASC(N$):GET1,P+4:L=L+256*ASC(N$):P=P+5
30 FORI=0TO3:GOSUB1000:N(I)=A:GOSUB1000:N(I)=N(I)+A*256:PRINTN(I):NEXT
35 P=P+N(0)-8
40 DIMD(600),F(600),V(600):I=0
50 GOSUB1000:IFA=255THEN100
60 D(I)=A:GOSUB1000:D(I)=D(I)+A*256:GOSUB1000:F(I)=AAND&H3F:GOSUB1000:F(I)=(AAND15)+F(I)*16:GOSUB1000:V(I)=(AAND15)XOR15:PRINTD(I);F(I);V(I):I=I+1:GOTO50
100 M=I:I=0:SOUND7,&B001000:ONINTERVAL=1GOSUB110:INTERVALON
105 GOTO 105
110 D(I)=D(I)-1:IFD(I)>0THENRETURNELSESOUND0,F(I)AND255:SOUND1,F(I)\256:SOUND8,V(I):I=I+1:IFI<MTHENRETURNELSEEND
999 END
1000 GET1,P:P=P+1:L=L-1:A=ASC(N$):RETURN
