10 MAXFILES=2:OPEN"PICDIR"AS1LEN=1:FIELD1,1ASN$:PRINT"Figura (0-";(LOF(1)/3)-1;")";:INPUTN:FORI=0TO2:GET1,N*3+I+1:A(I)=ASC(N$):NEXT:V=A(0)\16:P=((A(0)AND15)*256+A(1))*256+A(2):IFV>2THENPRINT"Nao existe. Tente outra.":ENDELSECLOSE
20 P=P+1:OPEN"VOL."+RIGHT$(STR$(V),1)AS1LEN=1:FIELD1,1ASN$:GET1,P:A=ASC(N$):GET1,P+1:B=ASC(N$):GET1,P+2:C=ASC(N$):IFNOT(&H12=AAND&H34=BANDC=V)THENPRINT"Invalido.":ENDELSEGET1,P+3:L=ASC(N$):GET1,P+4:L=L+256*ASC(N$):P=P+5
30 COLOR0,15,0:SCREEN5:SETPAGE0,0:FORI=0TO15:A=-2*(I>7):COLOR=(I,A-5*((IAND4)>0),A-5*((IAND2)>0),A-5*((IAND1)>0)):NEXT:LINE(160,0)-(255,211),0,BF:LINE(0,168)-(255,211),0,BF
35 SETPAGE1,1:COLOR,0:CLS:LINE(160,0)-(255,211),15,BF:LINE(0,168)-(255,211),15,BF:COLOR,15:SETPAGE0,0
40 GOSUB1000:IFA=&HFFTHEN3000ELSEIFA<&HF0ORA>&HF8THENGOTO1010ELSEONA-&HEFGOSUB100,200,300,400,500,600,700,800,900:GOTO40
100 GOSUB1000:COLORA:EN=1:RETURN
200 EN=0:RETURN
300 GOSUB1000:RETURN
400 RETURN
500 GOSUB1000:X1=A:GOSUB1000:Y1=A:GOTO620
600 GOSUB1000:X1=A:GOSUB1000:Y1=A
610 GOSUB1000:IFA>&HEFTHENP=P-1:L=L+1:RETURNELSELINE(X1,Y1)-(A,Y1):SETPAGE,1:LINE(X1,Y1)-(A,Y1),15:X1=A:SETPAGE,0
620 GOSUB1000:IFA>&HEFTHENP=P-1:L=L+1:RETURNELSELINE(X1,Y1)-(X1,A):SETPAGE,1:LINE(X1,Y1)-(X1,A),15:Y1=A:SETPAGE,0
630 GOTO 610
700 GOSUB1000:X1=A:GOSUB1000:Y1=A
710 GOSUB1000:X2=A:IFX2>&HEFTHENP=P-1:L=L+1:RETURNELSEGOSUB1000:Y2=A:IFEN=1THENLINE(X1,Y1)-(X2,Y2):SETPAGE,1:LINE(X1,Y1)-(X2,Y2),15:SETPAGE,0:X1=X2:Y1=Y2
720 GOTO 710
800 GOSUB1000:X1=A:GOSUB1000:Y1=A
805 GOSUB1000:IFA>&HEFTHENP=P-1:L=L+1:RETURN
810 X=(AAND&H70)\16:IF(AAND128)>0THENX=-X
820 Y=(AAND&H7):IF(AAND8)>0THENY=-Y
830 LINE(X1,Y1)-STEP(X,Y):SETPAGE,1:LINE(X1,Y1)-STEP(X,Y),15:SETPAGE,0:X1=X1+X:Y1=Y1+Y:GOTO805
900 GOSUB1000:X=A:IFX>&HEFTHENP=P-1:L=L+1:RETURNELSEGOSUB1000:Y=A
905 IFEN=0THEN900
910 SETPAGE,2:COPY(0,0)-(167,175),1TO(0,0),2:PAINT(X,Y),15,15:COPY(0,0)-(167,175),1TO(0,0),2,XOR:COPY(0,0)-(167,175),2TO(0,0),3:LINE(0,0)-(167,175),,BF,AND
915 SETPAGE,3:LINE(0,0)-(167,175),15,BF,XOR:SETPAGE,0:COPY(0,0)-(167,175),3TO(0,0),0,AND:COPY(0,0)-(167,175),2TO(0,0),0,OR:SETPAGE,1:PAINT(X,Y),15,15:SETPAGE,0
920 GOTO 900
1000 GET1,P:P=P+1:L=L-1:A=ASC(N$):RETURN
1010 SCREEN0:COLOR15,1,1:P1=INT(P/65536!):P2=P1*65536!:P3=P-P2:PRINT"Nao implementado:";HEX$(P1);HEX$(P3);HEX$(A):END
3000 OPEN"GRP:"FOROUTPUTAS#2:PRESET(180,0):COLOR15,0:PRINT#2,"OK":A$=INPUT$(1)
